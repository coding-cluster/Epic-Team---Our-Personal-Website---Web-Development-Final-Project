# Gu√≠a Completa de Scripts para Apache Tomcat
## Proyecto Final - Lenguajes de Computaci√≥n IV

---

## üìã √çndice

1. [Introducci√≥n](#introducci√≥n)
2. [Requisitos Previos](#requisitos-previos)
3. [Scripts Disponibles](#scripts-disponibles)
4. [Configuraci√≥n Inicial](#configuraci√≥n-inicial)
5. [Flujo de Trabajo Recomendado](#flujo-de-trabajo-recomendado)
6. [Gu√≠a de Uso Detallada](#gu√≠a-de-uso-detallada)
7. [Soluci√≥n de Problemas](#soluci√≥n-de-problemas)
8. [URLs Importantes](#urls-importantes)
9. [Comandos de Emergencia](#comandos-de-emergencia)

---

## üöÄ Introducci√≥n

Este proyecto incluye una colecci√≥n completa de scripts automatizados para gestionar Apache Tomcat de manera eficiente. Los scripts est√°n dise√±ados para simplificar las tareas de desarrollo y despliegue, eliminando la necesidad de configuraciones manuales complejas.

### Tipos de Scripts Incluidos:
- **PowerShell (.ps1)**: Scripts principales con funcionalidad completa
- **Batch (.bat)**: Wrappers para ejecutar scripts PowerShell f√°cilmente

---

## ‚öôÔ∏è Requisitos Previos

### Software Necesario:
- ‚úÖ **Java JDK 8+** (Oracle JDK o OpenJDK)
- ‚úÖ **Apache Tomcat 9.0+** (se busca autom√°ticamente en rutas comunes)
- ‚úÖ **Windows PowerShell 5.0+**

### Permisos de Ejecuci√≥n:
Si es la primera vez que ejecutas scripts de PowerShell, es posible que necesites cambiar la pol√≠tica de ejecuci√≥n:

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

## üìÅ Scripts Disponibles

### Scripts PowerShell Principales (.ps1)

| Script | Funci√≥n | Descripci√≥n |
|--------|---------|-------------|
| `start-tomcat.ps1` | ‚ñ∂Ô∏è Iniciar Tomcat | Inicia el servidor Apache Tomcat y verifica que est√© funcionando |
| `stop-tomcat.ps1` | ‚èπÔ∏è Detener Tomcat | Detiene el servidor de forma segura o forzada si es necesario |
| `restart-tomcat.ps1` | üîÑ Reiniciar Tomcat | Detiene y vuelve a iniciar el servidor |
| `status-tomcat.ps1` | üìä Estado del Servidor | Muestra informaci√≥n detallada del estado de Tomcat |
| `deploy-project.ps1` | üöÄ Desplegar Proyecto | Despliega autom√°ticamente el proyecto web en Tomcat |
| `setup-env.ps1` | ‚öôÔ∏è Configurar Entorno | Configura variables de entorno JAVA_HOME y CATALINA_HOME |
| `tomcat-help.ps1` | ‚ùì Ayuda | Muestra ayuda r√°pida de todos los comandos |

### Scripts Batch (.bat)

| Script | Equivalente PowerShell | Uso |
|--------|----------------------|-----|
| `start.bat` | `start-tomcat.ps1` | Doble clic para iniciar Tomcat |
| `stop.bat` | `stop-tomcat.ps1` | Doble clic para detener Tomcat |
| `deploy.bat` | `deploy-project.ps1` | Doble clic para desplegar proyecto |

---

## üîß Configuraci√≥n Inicial

### 1. Primera Configuraci√≥n del Entorno

```powershell
# Ejecutar desde la carpeta del proyecto
.\setup-env.ps1
```

Este script:
- üîç Detecta autom√°ticamente la instalaci√≥n de Java
- üîç Detecta autom√°ticamente la instalaci√≥n de Tomcat
- ‚öôÔ∏è Configura variables de entorno temporales
- üíæ Opcionalmente configura variables permanentes

### 2. Verificar la Configuraci√≥n

```powershell
.\status-tomcat.ps1
```

---

## üîÑ Flujo de Trabajo Recomendado

### Para Desarrollo Diario:

```powershell
# 1. Iniciar el servidor Tomcat
.\start-tomcat.ps1

# 2. Desplegar tu proyecto
.\deploy-project.ps1

# 3. [Realizar cambios en el c√≥digo...]

# 4. Re-desplegar despu√©s de cambios
.\deploy-project.ps1

# 5. Al terminar el d√≠a
.\stop-tomcat.ps1
```

### Para Resoluci√≥n de Problemas:

```powershell
# 1. Verificar el estado
.\status-tomcat.ps1

# 2. Reiniciar si hay problemas
.\restart-tomcat.ps1

# 3. Verificar que funcione
.\status-tomcat.ps1
```

---

## üìñ Gu√≠a de Uso Detallada

### ‚ñ∂Ô∏è Iniciar Tomcat

```powershell
.\start-tomcat.ps1
```

**Qu√© hace:**
- Busca autom√°ticamente la instalaci√≥n de Tomcat en rutas comunes
- Verifica si Tomcat ya est√° corriendo (evita duplicados)
- Ejecuta el script `startup.bat` de Tomcat
- Espera hasta 20 segundos para verificar que el servidor responda
- Muestra las URLs importantes una vez iniciado

**Salida esperada:**
```
INICIANDO APACHE TOMCAT...
Usando Tomcat en: C:\apache-tomcat-9.0.105
Ejecutando startup.bat...
Tomcat iniciado correctamente!
Servidor disponible en: http://localhost:8080
Manager: http://localhost:8080/manager
```

### ‚èπÔ∏è Detener Tomcat

```powershell
.\stop-tomcat.ps1
```

**Qu√© hace:**
- Identifica procesos de Tomcat en ejecuci√≥n
- Intenta detener usando `shutdown.bat` (m√©todo seguro)
- Si no responde, fuerza el cierre del proceso
- Verifica que el servidor se haya detenido completamente

**Salida esperada:**
```
Deteniendo Apache Tomcat...
Usando Tomcat en: C:\apache-tomcat-9.0.105
Deteniendo Tomcat (PID: 1234)...
Ejecutando shutdown.bat...
Tomcat detenido correctamente!
```

### üîÑ Reiniciar Tomcat

```powershell
.\restart-tomcat.ps1
```

**Qu√© hace:**
- Ejecuta `stop-tomcat.ps1`
- Espera 3 segundos para asegurar el cierre completo
- Ejecuta `start-tomcat.ps1`
- Verifica que ambas operaciones sean exitosas

### üìä Verificar Estado

```powershell
.\status-tomcat.ps1
```

**Informaci√≥n que muestra:**
- ‚úÖ Estado del proceso (corriendo/detenido)
- üÜî PID del proceso
- üíæ Uso de memoria
- ‚è∞ Tiempo de ejecuci√≥n
- üåê Conectividad web (puerto 8080)
- üîß Estado del Manager
- üîå Estado de puertos (8080, 8443, 8005, 8009)
- üìÅ Instalaciones de Tomcat encontradas
- ‚öôÔ∏è Variables de entorno JAVA_HOME y CATALINA_HOME

### üöÄ Desplegar Proyecto

```powershell
# Despliegue b√°sico
.\deploy-project.ps1

# Despliegue con nombre personalizado
.\deploy-project.ps1 -ProjectName "MiProyecto"
```

**Qu√© hace:**
1. Busca la carpeta `src\main\webapp` en el directorio actual
2. Localiza la instalaci√≥n de Tomcat
3. Elimina despliegue anterior si existe
4. Copia todos los archivos del proyecto a `webapps/[ProjectName]`
5. Verifica si Tomcat est√° corriendo
6. Si no est√° corriendo, lo inicia autom√°ticamente
7. Abre el proyecto en el navegador predeterminado

**Estructura de despliegue:**
```
webapps/
‚îî‚îÄ‚îÄ ProyectoFinal/          # o el nombre que especifiques
    ‚îú‚îÄ‚îÄ index.jsp
    ‚îú‚îÄ‚îÄ css/
    ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
    ‚îú‚îÄ‚îÄ js/
    ‚îÇ   ‚îî‚îÄ‚îÄ script.js
    ‚îî‚îÄ‚îÄ WEB-INF/
        ‚îî‚îÄ‚îÄ web.xml
```

### ‚öôÔ∏è Configurar Variables de Entorno

```powershell
.\setup-env.ps1
```

**Proceso interactivo:**
1. **Detecci√≥n de Java**: Busca en rutas comunes como:
   - `C:\Program Files\Java\jdk*`
   - `C:\Program Files\Java\jre*`
   - `C:\Program Files (x86)\Java\jdk*`

2. **Detecci√≥n de Tomcat**: Busca en:
   - `C:\apache-tomcat-11`
   - `C:\apache-tomcat-9.0.105`
   - `C:\Tomcat Server`

3. **Configuraci√≥n temporal**: Se aplica a la sesi√≥n actual de PowerShell

4. **Configuraci√≥n permanente**: Pregunta si quieres guardar en variables de usuario

### ‚ùì Obtener Ayuda

```powershell
.\tomcat-help.ps1
```

Muestra una referencia r√°pida de todos los comandos, ejemplos de uso y soluci√≥n de problemas comunes.

---

## üõ†Ô∏è Soluci√≥n de Problemas

### Problema: "No se encontr√≥ instalaci√≥n de Tomcat"

**Causas posibles:**
- Tomcat no est√° instalado
- Tomcat est√° en una ruta no est√°ndar
- Variable CATALINA_HOME no configurada

**Soluciones:**
1. Ejecutar `.\setup-env.ps1` para configurar autom√°ticamente
2. Instalar Tomcat en una ruta est√°ndar
3. Configurar manualmente CATALINA_HOME:
   ```powershell
   $env:CATALINA_HOME = "C:\ruta\a\tu\tomcat"
   ```

### Problema: "No se encontr√≥ instalaci√≥n de Java"

**Soluciones:**
1. Instalar Java JDK desde [Oracle](https://www.oracle.com/java/technologies/downloads/) u [OpenJDK](https://openjdk.org/)
2. Ejecutar `.\setup-env.ps1` despu√©s de la instalaci√≥n
3. Configurar manualmente JAVA_HOME:
   ```powershell
   $env:JAVA_HOME = "C:\Program Files\Java\jdk-11.0.x"
   ```

### Problema: "Puerto 8080 est√° ocupado"

**Diagn√≥stico:**
```powershell
netstat -ano | findstr :8080
```

**Soluciones:**
1. Cambiar el puerto en `server.xml` de Tomcat
2. Detener el proceso que usa el puerto
3. Usar un puerto alternativo

### Problema: "Tomcat no responde despu√©s de iniciar"

**Pasos de diagn√≥stico:**
1. Verificar logs:
   ```powershell
   Get-Content "C:\ruta\tomcat\logs\catalina.out" -Tail 50
   ```
2. Verificar estado:
   ```powershell
   .\status-tomcat.ps1
   ```
3. Reiniciar completamente:
   ```powershell
   .\restart-tomcat.ps1
   ```

### Problema: "Error de permisos al ejecutar scripts"

**Soluci√≥n:**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Problema: "El proyecto no se despliega correctamente"

**Verificaciones:**
1. Aseg√∫rate de que existe `src\main\webapp\`
2. Verifica que `web.xml` est√© en `WEB-INF\`
3. Comprueba permisos de escritura en `webapps\`
4. Revisar logs de Tomcat para errores espec√≠ficos

---

## üåê URLs Importantes

### URLs Principales:

| URL | Descripci√≥n | Uso |
|-----|-------------|-----|
| `http://localhost:8080` | P√°gina principal de Tomcat | Verificar que Tomcat funciona |
| `http://localhost:8080/ProyectoFinal` | Tu proyecto desplegado | Acceder a tu aplicaci√≥n |
| `http://localhost:8080/manager` | Manager de aplicaciones | Gestionar aplicaciones web |
| `http://localhost:8080/host-manager` | Manager de hosts | Gestionar hosts virtuales |

### URLs de Desarrollo:

| URL | Archivo | Descripci√≥n |
|-----|---------|-------------|
| `http://localhost:8080/ProyectoFinal/` | `index.jsp` | P√°gina principal |
| `http://localhost:8080/ProyectoFinal/css/styles.css` | `styles.css` | Estilos CSS |
| `http://localhost:8080/ProyectoFinal/js/script.js` | `script.js` | JavaScript |

---

## üö® Comandos de Emergencia

### Forzar Detenci√≥n de Tomcat:
```powershell
# Encontrar y matar proceso de Tomcat
Get-Process -Name "java" | Where-Object { $_.CommandLine -like "*catalina*" } | Stop-Process -Force
```

### Limpiar Puertos Bloqueados:
```powershell
# Ver qu√© proceso usa el puerto 8080
netstat -ano | findstr :8080

# Matar proceso por PID (reemplaza XXXX con el PID real)
taskkill /PID XXXX /F
```

### Verificar Instalaciones:
```powershell
# Verificar Java
java -version

# Verificar variables de entorno
echo $env:JAVA_HOME
echo $env:CATALINA_HOME
```

### Acceso R√°pido a Logs:
```powershell
# Ver √∫ltimas l√≠neas del log de Tomcat
Get-Content "C:\apache-tomcat-*\logs\catalina.out" -Tail 20 -Wait
```

---

## üìù Notas Importantes

### Buenas Pr√°cticas:
- ‚úÖ Siempre usar `.\stop-tomcat.ps1` antes de cerrar la computadora
- ‚úÖ Verificar el estado con `.\status-tomcat.ps1` si hay problemas
- ‚úÖ Usar nombres de proyecto descriptivos en `.\deploy-project.ps1`
- ‚úÖ Mantener copias de seguridad de `web.xml` y configuraciones importantes

### Estructura de Archivos Requerida:
```
Proyecto/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ main/
‚îÇ       ‚îî‚îÄ‚îÄ webapp/
‚îÇ           ‚îú‚îÄ‚îÄ index.jsp          # Requerido
‚îÇ           ‚îú‚îÄ‚îÄ css/
‚îÇ           ‚îú‚îÄ‚îÄ js/
‚îÇ           ‚îî‚îÄ‚îÄ WEB-INF/
‚îÇ               ‚îî‚îÄ‚îÄ web.xml        # Requerido
‚îî‚îÄ‚îÄ [scripts de tomcat]
```

### Variables de Entorno Importantes:
- `JAVA_HOME`: Ruta al JDK de Java
- `CATALINA_HOME`: Ruta de instalaci√≥n de Tomcat
- `PATH`: Debe incluir `%JAVA_HOME%\bin`

---

## üÜò Soporte y Contacto

Si encuentras problemas no cubiertos en esta gu√≠a:

1. **Revisar logs de Tomcat**: `logs\catalina.out`
2. **Ejecutar diagn√≥stico**: `.\status-tomcat.ps1`
3. **Consultar documentaci√≥n oficial**: [Apache Tomcat Documentation](https://tomcat.apache.org/tomcat-9.0-doc/)

---

**Proyecto Final - Lenguajes de Computaci√≥n IV**  
Universidad Aut√≥noma de Aguascalientes  
*Creado con ‚ù§Ô∏è para simplificar el desarrollo web con Java*
